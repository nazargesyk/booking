{
    "metadata": {
        "title": "RegressionTestDEV_AutoTest",
        "description": "Often Author: Kostiantyn K . License: https://github.com/Neo23x0/sigma/blob/master/LICENSE.Detection.Rules.md. Reference: https://tdm.socprime.com/tdm/info/",
        "tags": [
            "attack.initial_access",
            "attack.t1190"
        ],
        "query": "(url.original:(edrf* OR vbght* OR ______* OR \\-\\-* OR ;* OR %3\\^\\^B* OR %7C* OR %##3E* OR %6%%0* OR >* OR `>* OR %\\&&60* OR @@@@* OR %40&*%40* OR %20%2\\(\\(F* OR \\||* OR %7C%7C%$#* OR \\(\\)*) OR query:/.*[Tt][Ju][Bb][Rr]\\(.*/)"
    },
    "trigger": {
        "schedule": {
            "interval": "30m"
        }
    },
    "input": {
        "search": {
            "request": {
                "body": {
                    "size": 0,
                    "query": {
                        "bool": {
                            "must": [
                                {
                                    "query_string": {
                                        "query": "(url.original:(edrf* OR vbght* OR ______* OR \\-\\-* OR ;* OR %3\\^\\^B* OR %7C* OR %##3E* OR %6%%0* OR >* OR `>* OR %\\&&60* OR @@@@* OR %40&*%40* OR %20%2\\(\\(F* OR \\||* OR %7C%7C%$#* OR \\(\\)*) OR query:/.*[Tt][Ju][Bb][Rr]\\(.*/)",
                                        "analyze_wildcard": true
                                    }
                                }
                            ],
                            "filter": {
                                "range": {
                                    "@timestamp": {
                                        "gte": "now-30m/m"
                                    }
                                }
                            }
                        }
                    }
                },
                "indices": [
                    "filebeat-*"
                ]
            }
        }
    },
    "condition": {
        "compare": {
            "ctx.payload.hits.total": {
                "not_eq": 0
            }
        }
    },
    "actions": {
        "send_email": {
            "throttle_period": "15m",
            "email": {
                "profile": "standard",
                "from": "root@localhost",
                "to": "root@localhost",
                "subject": "Sigma Rule 'RegressionTestDEV_AutoTest'",
                "body": "Hits:\n{{#ctx.payload.hits.hits}}{{_source}}\n================================================================================\n{{/ctx.payload.hits.hits}}",
                "attachments": {
                    "data.json": {
                        "data": {
                            "format": "json"
                        }
                    }
                }
            }
        }
    }
}